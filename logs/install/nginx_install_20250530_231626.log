
================================================================================
DÉMARRAGE: nginx_install
Description: Installation Nginx et Dashboard (hybride)
Date: Fri 30 May 23:16:26 CEST 2025
Utilisateur: root
Répertoire: /media/prod/MAXLINK
================================================================================

[2025-05-30 23:16:26] [INFO] [nginx_install] Script nginx_install initialisé
[2025-05-30 23:16:26] [INFO] [nginx_install] ========== DÉBUT DE L'INSTALLATION NGINX ET DASHBOARD (HYBRIDE) ==========
[2025-05-30 23:16:26] [INFO] [nginx_install] Progression: 5% - Vérifications initiales...
[2025-05-30 23:16:26] [INFO] [nginx_install] Privilèges root confirmés
[2025-05-30 23:16:27] [INFO] [nginx_install] Progression: 10% - Vérifications terminées
[2025-05-30 23:16:29] [INFO] [nginx_install] Progression: 20% - Installation de Nginx...
[2025-05-30 23:16:29] [INFO] [nginx_install] Installation hybride de Nginx
[2025-05-30 23:16:29] [INFO] [nginx_install] Tentative d'installation depuis le cache
[2025-05-30 23:16:31] [SUCCESS] [nginx_install] Nginx installé depuis le cache
[2025-05-30 23:16:31] [SUCCESS] [nginx_install] Nginx installé avec succès
[2025-05-30 23:16:31] [CMD] [nginx_install] Exécution: Arrêt Nginx
[2025-05-30 23:16:31] [CMD] [nginx_install] Commande: systemctl stop nginx >/dev/null 2>&1
[2025-05-30 23:16:31] [CMD] [nginx_install] Code de sortie: 0
[2025-05-30 23:16:32] [INFO] [nginx_install] Progression: 35% - Nginx installé
[2025-05-30 23:16:34] [INFO] [nginx_install] Progression: 40% - Installation du dashboard...
[2025-05-30 23:16:34] [INFO] [nginx_install] Vérification du cache dashboard
[2025-05-30 23:16:34] [INFO] [nginx_install] Dashboard trouvé dans le cache
[2025-05-30 23:16:34] [INFO] [nginx_install] Répertoire temporaire: /tmp/maxlink-dashboard-1748639794
[2025-05-30 23:16:34] [CMD] [nginx_install] Exécution: Extraction archive
[2025-05-30 23:16:34] [CMD] [nginx_install] Commande: tar -xzf '/var/cache/maxlink/dashboard/dashboard.tar.gz' -C '/tmp/maxlink-dashboard-1748639794'
[2025-05-30 23:16:34] [CMD] [nginx_install] Code de sortie: 0
[2025-05-30 23:16:34] [SUCCESS] [nginx_install] Archive extraite avec succès
[2025-05-30 23:16:35] [INFO] [nginx_install] Dossier racine de l'archive: /tmp/maxlink-dashboard-1748639794/MaxLink-main
[2025-05-30 23:16:35] [INFO] [nginx_install] Recherche du dashboard dans: /tmp/maxlink-dashboard-1748639794/MaxLink-main/DashBoardV1
[2025-05-30 23:16:35] [INFO] [nginx_install] Dossier dashboard trouvé: /tmp/maxlink-dashboard-1748639794/MaxLink-main/DashBoardV1
[2025-05-30 23:16:35] [CMD] [nginx_install] Exécution: Copie dashboard
[2025-05-30 23:16:35] [CMD] [nginx_install] Commande: cp -r '/tmp/maxlink-dashboard-1748639794/MaxLink-main/DashBoardV1' '/var/www/maxlink-dashboard'
[2025-05-30 23:16:35] [CMD] [nginx_install] Code de sortie: 0
[2025-05-30 23:16:35] [SUCCESS] [nginx_install] Dashboard installé avec succès
[2025-05-30 23:16:35] [INFO] [nginx_install] Nettoyage du répertoire temporaire
[2025-05-30 23:16:35] [CMD] [nginx_install] Exécution: Application permissions
[2025-05-30 23:16:35] [CMD] [nginx_install] Commande: chown -R www-data:www-data '/var/www/maxlink-dashboard'
[2025-05-30 23:16:36] [CMD] [nginx_install] Code de sortie: 0
[2025-05-30 23:16:36] [CMD] [nginx_install] Exécution: Application droits
[2025-05-30 23:16:36] [CMD] [nginx_install] Commande: chmod -R 755 '/var/www/maxlink-dashboard'
[2025-05-30 23:16:36] [CMD] [nginx_install] Code de sortie: 0
[2025-05-30 23:16:36] [INFO] [nginx_install] Progression: 60% - Dashboard installé
[2025-05-30 23:16:38] [INFO] [nginx_install] Progression: 70% - Configuration de Nginx...
[2025-05-30 23:16:38] [INFO] [nginx_install] Création de la configuration Nginx
[2025-05-30 23:16:38] [SUCCESS] [nginx_install] Configuration Nginx créée
[2025-05-30 23:16:38] [CMD] [nginx_install] Exécution: Suppression site par défaut
[2025-05-30 23:16:39] [CMD] [nginx_install] Commande: rm -f /etc/nginx/sites-enabled/default 2>/dev/null || true
[2025-05-30 23:16:39] [CMD] [nginx_install] Code de sortie: 0
[2025-05-30 23:16:39] [CMD] [nginx_install] Exécution: Suppression ancien lien
[2025-05-30 23:16:39] [CMD] [nginx_install] Commande: rm -f /etc/nginx/sites-enabled/maxlink-dashboard 2>/dev/null || true
[2025-05-30 23:16:39] [CMD] [nginx_install] Code de sortie: 0
[2025-05-30 23:16:39] [CMD] [nginx_install] Exécution: Création lien symbolique
[2025-05-30 23:16:39] [CMD] [nginx_install] Commande: ln -s /etc/nginx/sites-available/maxlink-dashboard /etc/nginx/sites-enabled/
[2025-05-30 23:16:39] [CMD] [nginx_install] Code de sortie: 0
[2025-05-30 23:16:39] [INFO] [nginx_install] Site Nginx activé
[2025-05-30 23:16:39] [CMD] [nginx_install] Exécution: Test configuration Nginx
[2025-05-30 23:16:40] [CMD] [nginx_install] Commande: nginx -t >/dev/null 2>&1
[2025-05-30 23:16:40] [CMD] [nginx_install] Code de sortie: 0
[2025-05-30 23:16:40] [SUCCESS] [nginx_install] Configuration Nginx valide
[2025-05-30 23:16:40] [CMD] [nginx_install] Exécution: Activation au démarrage
[2025-05-30 23:16:40] [CMD] [nginx_install] Commande: systemctl enable nginx >/dev/null 2>&1
[2025-05-30 23:16:41] [CMD] [nginx_install] Code de sortie: 0
[2025-05-30 23:16:41] [CMD] [nginx_install] Exécution: Démarrage Nginx
[2025-05-30 23:16:41] [CMD] [nginx_install] Commande: systemctl start nginx >/dev/null 2>&1
[2025-05-30 23:16:41] [CMD] [nginx_install] Code de sortie: 0
[2025-05-30 23:16:41] [SUCCESS] [nginx_install] Nginx démarré avec succès
[2025-05-30 23:16:41] [INFO] [nginx_install] Progression: 85% - Nginx configuré
[2025-05-30 23:16:43] [INFO] [nginx_install] Progression: 90% - Configuration DNS...
[2025-05-30 23:16:43] [INFO] [nginx_install] Vérification de la configuration AP existante
[2025-05-30 23:16:44] [INFO] [nginx_install] Mode AP détecté, mise à jour DNS nécessaire
[2025-05-30 23:16:44] [INFO] [nginx_install] Configuration DNS déjà présente
[2025-05-30 23:16:44] [INFO] [nginx_install] Progression: 100% - Installation terminée !
[2025-05-30 23:16:44] [INFO] [nginx_install] Installation terminée avec succès
[2025-05-30 23:16:44] [INFO] [nginx_install] Dashboard accessible à: http://192.168.4.1 et http://maxlink-dashboard.local
[2025-05-30 23:16:44] [INFO] [nginx_install] Redémarrage du système prévu dans 10 secondes
[2025-05-30 23:16:54] [INFO] [nginx_install] Redémarrage du système
[2025-05-30 23:16:54] [INFO] [nginx_install] Script nginx_install terminé avec le code 0
